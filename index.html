<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Maya â¤ï¸</title>

<style>
  body{
    background: linear-gradient(135deg,#ff758c,#ff7eb3);
    height:100vh;
    text-align:center;
    font-family:"Segoe UI", Arial, Helvetica, sans-serif;
    overflow:hidden;
    margin:0;
  }

  #content{
    position:relative;
    z-index:2;
  }

  h1{
    margin-top:90px;
    font-size:42px;
    color:white;
    text-shadow:2px 2px 8px #00000060;
  }

  h2{
    color:white;
    margin: 30px 20px 60px;
    position: relative;
    z-index: 2;
    line-height:1.6;
  }

  .btn{
    padding:16px 34px;
    font-size:20px;
    border:none;
    border-radius:14px;
    cursor:pointer;
    position:absolute;
    transition:0.2s;
    box-shadow:0 8px 18px rgba(0,0,0,0.25);
    z-index: 3; /* keep buttons above everything */
  }

  #yes{
    background:#ff2e63;
    color:white;
    left:35%;
    top:70%;
  }

  #no{
    background:#333;
    color:white;
    left:55%;
    top:70%;
  }

  .heart{
    position:absolute;
    color:red;
    font-size:26px;
    animation: float 5s linear infinite;
    z-index: 1;
  }

  @keyframes float{
    from{ transform:translateY(100vh); opacity:1; }
    to{ transform:translateY(-10vh); opacity:0; }
  }

  @media (max-width: 600px) {
    #yes{ left:25%; top:75%; }
    #no{ left:55%; top:75%; }
  }
</style>
</head>

<body>

<!-- Keep audio OUTSIDE content so it never gets removed -->
<audio id="bgMusic" loop preload="auto">
  <source src="./perfect.mp3" type="audio/mpeg">
</audio>

<div id="content">
  <h1>Maya ğŸ’•</h1>

  <h2>
    Pyaru has a very important question for youâ€¦ ğŸ¥º<br><br>

    Since the day we started talking on Nov 12, 2019 and met on <b>October 25, 2022</b>,<br>
    my life quietly upgraded from normal mode to happiness mode â¤ï¸<br><br>

    (You still owe me one real-life hug â€” Whatsapp video call doesnâ€™t count ğŸ˜Œâ¤ï¸.
    Also, owe me one â€˜see you at the airportâ€™ moment â€” ETA: very soon âœˆï¸ğŸ’•)<br><br>

    <b>Will you be my Valentine?</b>
  </h2>

  <button id="yes" class="btn">YES ğŸ’–</button>
  <button id="no" class="btn">NO ğŸ™ƒ</button>
</div>

<script>
  const noBtn   = document.getElementById("no");
  const yesBtn  = document.getElementById("yes");
  const music   = document.getElementById("bgMusic");
  const content = document.getElementById("content");

  // NO button runs away (desktop + mobile)
  noBtn.addEventListener("mouseover", moveButton);
  noBtn.addEventListener("click", moveButton);
  noBtn.addEventListener("touchstart", moveButton);

  function moveButton(){
    const x = Math.random() * (window.innerWidth - 140);
    const y = Math.random() * (window.innerHeight - 100);
    noBtn.style.left = x + "px";
    noBtn.style.top  = y + "px";
  }

  // Make "start at 20s" reliable (wait for metadata)
  function waitForMetadata(audioEl){
    return new Promise((resolve) => {
      if (audioEl.readyState >= 1) return resolve(); // HAVE_METADATA
      audioEl.addEventListener("loadedmetadata", () => resolve(), { once: true });
    });
  }

  yesBtn.addEventListener("click", async () => {
    try{
      await waitForMetadata(music);
      music.currentTime = 20;   // start from 20s
      music.volume = 0.6;
      await music.play();
      // set again after play (some browsers are picky)
      music.currentTime = 20;
    }catch(e){
      console.log("Music play issue:", e);
      // Even if music fails, continue the surprise
    }

    accepted();
  });

  function accepted(){
    // Replace ONLY the content area, NOT the entire body (keeps audio alive)
    content.innerHTML = `
      <h1 style="margin-top:160px;color:white;line-height:1.6;">
        YAAAY Maya!!! â¤ï¸â¤ï¸â¤ï¸<br><br>
        You just made Pyaru the happiest man alive ğŸ’<br><br>
        Distance may separate us,<br>
        but my heart has always been right there with you ğŸŒâ¤ï¸<br><br>
        I love you today, tomorrow, and forever ğŸŒ¹
      </h1>
    `;
    hearts();
  }

  function hearts(){
    setInterval(()=>{
      const heart = document.createElement("div");
      heart.className = "heart";
      heart.innerHTML = "â¤ï¸";
      heart.style.left = Math.random() * 100 + "vw";
      document.body.appendChild(heart);
      setTimeout(()=>heart.remove(), 5000);
    }, 250);
  }
</script>

</body>
</html>
